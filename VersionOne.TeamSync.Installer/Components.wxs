<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <?include $(sys.CURRENTDIR)\Config.wxi ?>
	
  <Fragment>
    <!-- Components included in the installation. All the component shared the same directory folder -->
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="HtmlAgilityPack.dll">
        <File Source="$(var.SourceDir)\HtmlAgilityPack.dll" />
      </Component>
      <Component Id="InstallUtil.exe">
        <File Source="$(var.SourceDir)\InstallUtil.exe" />
      </Component>
      <Component Id="log4net.dll">
        <File Source="$(var.SourceDir)\log4net.dll" />
      </Component>
      <Component Id="Newtonsoft.Json.dll">
        <File Source="$(var.SourceDir)\Newtonsoft.Json.dll" />
      </Component>
      <Component Id="RestSharp.dll">
        <File Source="$(var.SourceDir)\RestSharp.dll" />
      </Component>
      <Component Id="VersionOne.TeamSync.Core.dll">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.Core.dll" />
      </Component>
      <Component Id="VersionOne.TeamSync.Service.exe">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.Service.exe" />

        <!-- Installs the TeamSync service. -->
        <ServiceInstall Id="ServiceInstaller"
                            Type="ownProcess"
                            Name="VersionOne.TeamSync.Service"
                            DisplayName="[ProductName] Service"
                            Description="Manages VersionOne integrations with external team tools."
                            Start="demand"
                            ErrorControl="normal" />
        <ServiceControl Id="StartService" Stop="both" Remove="uninstall" Name="VersionOne.TeamSync.Service" Wait="no" />

      </Component>
      <Component Id="VersionOne.TeamSync.Service.exe.config">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.Service.exe.config" />
      </Component>
      <Component Id="VersionOne.TeamSync.SystemTray.exe">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.SystemTray.exe" />
      </Component>
      <Component Id="VersionOne.TeamSync.SystemTray.exe.config">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.SystemTray.exe.config" />
      </Component>
      <Component Id="VersionOne.TeamSync.V1Connector.dll">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.V1Connector.dll" />
      </Component>
    <Component Id="VersionOne.TeamSync.Worker.dll">
        <File Source="$(var.SourceDir)\VersionOne.TeamSync.Worker.dll" />
      </Component>
  
      <Component Id="versionone_logo_noTagline.png">
        <File Source="$(var.SourceDir)\versionone-logo-noTagline.png" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>